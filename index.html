<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chat Simplu</title>
<style>
  body {
    font-family: Arial;
    background: #121212;
    color: white;
    text-align: center;
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
  }
  #chat {
    flex: 1;
    width: 100%;
    overflow-y: scroll;
    padding: 10px;
    background: #1e1e1e;
    box-sizing: border-box;
  }
  #baraMesaj {
    display: flex;
    width: 100%;
    background: #222;
    padding: 8px;
    box-sizing: border-box;
    position: fixed;
    bottom: 0;
    left: 0;
  }
  #msg {
    flex: 1;
    padding: 10px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
  }
  #trimiteBtn {
    margin-left: 8px;
    background: #00bfff;
    border: none;
    border-radius: 5px;
    color: white;
    font-weight: bold;
    padding: 10px 15px;
    font-size: 16px;
  }
  input, button, select {
    border: none;
    border-radius: 5px;
  }
  button { cursor: pointer; }
  #numeInput, #selecteazaLimba {
    margin-top: 50px;
  }
</style>
</head>
<body>

<h2 id="titlu">ðŸ’¬ Chat Online</h2>

<div id="selecteazaLimba">
  <p>Alege limba / Choose language:</p>
  <select id="limba">
    <option value="ro">RomÃ¢nÄƒ ðŸ‡·ðŸ‡´</option>
    <option value="en">English ðŸ‡¬ðŸ‡§</option>
  </select><br>
  <button onclick="salveazaLimba()">ContinuÄƒ</button>
</div>

<div id="numeInput" style="display:none;">
  <p id="textNume">Scrie-È›i numele:</p>
  <input type="text" id="nume" placeholder="Ex: user123">
  <button onclick="salveazaNume()">SalveazÄƒ</button>
</div>

<div id="zonaChat" style="display:none; flex:1; flex-direction:column;">
  <div id="chat"></div>

  <div id="baraMesaj">
    <input type="text" id="msg" placeholder="Scrie un mesaj...">
    <button id="trimiteBtn" onclick="trimite()">Trimite</button>
  </div>
</div>

<script>
let chat = document.getElementById("chat");
let user = localStorage.getItem("numeChat");
let lang = localStorage.getItem("limbaChat");

function traduce() {
  if (lang === "en") {
    document.getElementById("titlu").textContent = "ðŸ’¬ Online Chat";
    document.getElementById("textNume").textContent = "Enter your name:";
    document.getElementById("msg").placeholder = "Write a message...";
    document.getElementById("trimiteBtn").textContent = "Send";
  }
}

if (lang) {
  document.getElementById("selecteazaLimba").style.display = "none";
  document.getElementById("numeInput").style.display = user ? "none" : "block";
  document.getElementById("zonaChat").style.display = user ? "flex" : "none";
  traduce();
}

if (user && lang) traduce();

function salveazaLimba() {
  lang = document.getElementById("limba").value;
  localStorage.setItem("limbaChat", lang);
  document.getElementById("selecteazaLimba").style.display = "none";
  document.getElementById("numeInput").style.display = "block";
  traduce();
}

function salveazaNume() {
  let nume = document.getElementById("nume").value.trim();
  if (nume === "") {
    if (lang === "en") alert("Enter a name!");
    else alert("Scrie un nume!");
    return;
  }
  localStorage.setItem("numeChat", nume);
  user = nume;
  document.getElementById("numeInput").style.display = "none";
  document.getElementById("zonaChat").style.display = "flex";
}

let ws = new WebSocket("wss://ws.postman-echo.com/raw");

ws.onmessage = (event) => {
  try {
    let msg = JSON.parse(event.data);
    let p = document.createElement("p");
    p.textContent = msg.user + ": " + msg.text;
    chat.appendChild(p);
    chat.scrollTop = chat.scrollHeight;
  } catch(e) {}
};

function trimite() {
  let text = document.getElementById("msg").value.trim();
  if (text === "") return;
  let mesaj = { user: user, text: text };
  ws.send(JSON.stringify(mesaj));
  document.getElementById("msg").value = "";
}
</script>

</body>
</html>